---
title: "WIP_code"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

standard library load
```{r}
library(readr)
library(dplyr)
library(tidyverse)
library(png)
library(raster)
library(rgdal)
library(ggplot2)
library(knitr)
library(leaflet)
library(maps)

library(RColorBrewer)
```


Actinotus forsythii data was downloaded from ALA
(this could also be turned into code that downlads straight from ala -although not particularly useful for non australian species)

```{r}
Actinotus_forsythii_alaobvs_28_10_21 <- read_csv("Actinotus_forsythii_alaobvs_28_10_21.csv")
View(Actinotus_forsythii_alaobvs_28_10_21)

Actinotus_forsythii <- dplyr::select(Actinotus_forsythii_alaobvs_28_10_21, raw_recordedBy, basisOfRecord, occurrenceRemarks, eventDate, year, month, day, habitat, stateProvince, locality, verbatimLocality, decimalLatitude, decimalLongitude)

View(Actinotus_forsythii)
```


checking if lat long line up with what is expexted

```{r}

world <- map_data("world")

ggplot() +
  geom_map(
    data = world, map = world,
    aes(long, lat, map_id = region),
    color = "white", fill = "lightgray", size = 0.1
    ) +
   theme_bw() +
  geom_point(
    data = Actinotus_forsythii,
    aes(decimalLongitude, decimalLatitude),
    alpha = 0.4, size = 0.1
    ) + scale_x_continuous(limits = c(140,155)) + scale_y_continuous(limits = c(-40,-30))

```


next...

Fire data needs to be attained

Fire data will be a grid where as lat, long of species data is a point. not sure if this will cause issues. 

Each location point has a date stamp. This date stap needs to be turned into a range and converted to the same format as the fire data date stamp. 

True/false for each data point if fire occours in the agreed date range. 

Percentage true false?



Using fire data from previous project (loaded into workspace from that project)
preliminalrily shows that graphically where we see fire, the following year we see A. forsythii now to try and test this.


```{r}
fire_2003_true <- subset(fire_2003, layer > 0)

Actinotus_forsythii_2003_burn <- subset(Actinotus_forsythii, year >2003 & year <2008)
```


```{r}
ggplot() +
  geom_map(
    data = world, map = world,
    aes(long, lat, map_id = region),
    color = "black", fill = "white", size = 0.1
    ) +
   theme_bw() +
  geom_point(
    data = fire_2003_true,
    aes(x, y, colour=layer),
    alpha = 0.5, size = 1
    ) + scale_x_continuous(limits = c(147.5,152.5)) + scale_y_continuous(limits = c(-40,-32.5)) + 
  geom_point(
    data = Actinotus_forsythii_2003_burn,
    aes(decimalLongitude, decimalLatitude),
   alpha =0.5, size = 1
    ) + scale_x_continuous(limits = c(147.5,152.5)) + scale_y_continuous(limits = c(-40,-32.5))
```



firstly how do inflate fire data to be a range rather than a point?

```{r}

fire_2003_test <- fire_2003 


xrange <- function(fire_data) {
  fire_data %>%  mutate(xrange = x + 0.250) 
}
yrange <- function(fire_data) {
  fire_data %>% mutate(yrange = y - 0.250)
}
fire_true <- function(fire_data) {
  fire_data %>% mutate(fire_true = if_else (layer !=	0, TRUE, FALSE))
}


fire_2003_test <- xrange(fire_2003)
fire_2003_test <- yrange(fire_2003_test)
fire_2003_test <- fire_true(fire_2003_test)


str(fire_2003_test)

```

ok, now I need to crass reference. 
does point plant fit between x-xrange 


give me fire_true where (decimallat is >yrange and <y) and (decimallong >xrange and <x)

```{r}
fire_true <- (Actinotus_forsythii_2003_burn$decimalLongitude > fire_2003_test$yrange 
  & < fire_2003_test$y) &
  (Actinotus_forsythii_2003_burn$decimalLatitude > fire_2003_test$xrange 
  & < fire_2003_test$x)


get_true <-function()
  
  
fire_2003_test %<% left_join(Actinotus_forsythii_2003_burn, by = c())  

```



















